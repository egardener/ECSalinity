<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API Reference</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/ECSalinity/assets/css/0.styles.86182990.css" as="style"><link rel="preload" href="/ECSalinity/assets/js/app.56bde8e3.js" as="script"><link rel="preload" href="/ECSalinity/assets/js/5.7e5ed0e9.js" as="script"><link rel="prefetch" href="/ECSalinity/assets/js/4.1a5e5c36.js"><link rel="prefetch" href="/ECSalinity/assets/js/2.c736891e.js"><link rel="prefetch" href="/ECSalinity/assets/js/3.4ad423ee.js"><link rel="prefetch" href="/ECSalinity/assets/js/6.df5a81d0.js"><link rel="prefetch" href="/ECSalinity/assets/js/7.722fa772.js"><link rel="prefetch" href="/ECSalinity/assets/js/8.64e526ff.js"><link rel="prefetch" href="/ECSalinity/assets/js/9.464216a6.js">
    <link rel="stylesheet" href="/ECSalinity/assets/css/0.styles.86182990.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/ECSalinity/" class="home-link router-link-exact-active router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/ECSalinity/" class="active sidebar-link">API Reference</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ECSalinity/#characteristics" class="sidebar-link">Characteristics</a></li><li class="sidebar-sub-header"><a href="/ECSalinity/#i2c-connections" class="sidebar-link">I2C Connections</a></li><li class="sidebar-sub-header"><a href="/ECSalinity/#temperature-probe-connections" class="sidebar-link">Temperature Probe Connections</a></li><li class="sidebar-sub-header"><a href="/ECSalinity/#i2c-bus-pull-ups" class="sidebar-link">I2C Bus Pull-ups</a></li><li class="sidebar-sub-header"><a href="/ECSalinity/#ec-probe-connections" class="sidebar-link">EC Probe Connections</a></li><li class="sidebar-sub-header"><a href="/ECSalinity/#raspberry-pi" class="sidebar-link">Raspberry Pi</a></li><li class="sidebar-sub-header"><a href="/ECSalinity/#the-shell-example" class="sidebar-link">The shell Example</a></li><li class="sidebar-sub-header"><a href="/ECSalinity/#changing-the-i2c-address" class="sidebar-link">Changing the I2C Address</a></li><li class="sidebar-sub-header"><a href="/ECSalinity/#temperature-compensation" class="sidebar-link">Temperature Compensation</a></li><li class="sidebar-sub-header"><a href="/ECSalinity/#temperature-coefficients" class="sidebar-link">Temperature Coefficients</a></li><li class="sidebar-sub-header"><a href="/ECSalinity/#measurement-time" class="sidebar-link">Measurement Time</a></li><li class="sidebar-sub-header"><a href="/ECSalinity/#isolation-and-interference" class="sidebar-link">Isolation and Interference</a></li></ul></li><li><a href="/ECSalinity/api.html" class="sidebar-link">Class Members</a></li></ul> </div> <div class="page"><!---->  <div class="content"><h1>Introduction</h1> <p>Measure Electrical Conductivity in Siemens, Total Dissolved Solids in PPM, and Salinity in PSU and PPT.</p> <p>Monitor hydroponic nutrient levels, salinity in aquariums, pools, or soil.</p> <h2 id="characteristics"><a href="#characteristics" aria-hidden="true" class="header-anchor">#</a> Characteristics</h2> <ul><li><strong>EC range</strong>: ~0.06 - ~200 mS depending on probe</li> <li><strong>Salinity range</strong>: 2 - 42</li> <li><strong>Accuracy</strong>: ± 5%</li> <li><strong>Temperature Precision</strong>: 0.05 C</li> <li><strong>Temperature range</strong>: -2 - 35C</li> <li><strong>Interface</strong>: I2C</li> <li><strong>Current use</strong>: ~10mA peak, low idle current ~1mA</li> <li><strong>Voltage range</strong>: 3.3 - 5.5V</li></ul> <h1>Connections</h1> <h2 id="i2c-connections"><a href="#i2c-connections" aria-hidden="true" class="header-anchor">#</a> I2C Connections</h2> <p>The connection to the device is as follows:</p> <div class="table"><table><thead><tr><th style="text-align:center">EC Salinity Probe</th> <th style="text-align:center">Master device</th></tr></thead> <tbody><tr><td style="text-align:center">GND</td> <td style="text-align:center">GND</td></tr> <tr><td style="text-align:center">SCL</td> <td style="text-align:center">SCL</td></tr> <tr><td style="text-align:center">SDA</td> <td style="text-align:center">SDA</td></tr> <tr><td style="text-align:center">3.3/5v</td> <td style="text-align:center">3.3 - 5V</td></tr></tbody></table></div> <h2 id="temperature-probe-connections"><a href="#temperature-probe-connections" aria-hidden="true" class="header-anchor">#</a> Temperature Probe Connections</h2> <p>The temperature probe comes with a 3-wire header; any 3-wire DS18B20 will work. The VCC pin is labeled with a triangle:</p> <div class="table"><table><thead><tr><th style="text-align:center">EC Salinity Probe</th> <th style="text-align:center">Temperature Probe</th></tr></thead> <tbody><tr><td style="text-align:center">▲ (VCC</td> <td style="text-align:center">▲</td></tr> <tr><td style="text-align:center">(Data)</td> <td style="text-align:center">(pin 2)</td></tr> <tr><td style="text-align:center">(GND)</td> <td style="text-align:center">(pin 3)</td></tr></tbody></table></div> <p>A standalone DS18B20 can be directly connected to the board, no resistor is required.</p> <h2 id="i2c-bus-pull-ups"><a href="#i2c-bus-pull-ups" aria-hidden="true" class="header-anchor">#</a> I2C Bus Pull-ups</h2> <p>Each device comes with 4.7k resistor pullups on the I2C bus. They pass through a 3-pad solder paste jumper. The outer pads are connected to the middle by thin traces. To disable the pullups, use a utility knife to cut both traces. To re-enable the pullups, connect all three pads together with solder.</p> <p><img src="data:image/png;base64,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" alt="solder paste jumper"></p> <h2 id="ec-probe-connections"><a href="#ec-probe-connections" aria-hidden="true" class="header-anchor">#</a> EC Probe Connections</h2> <p>A board with a BNC connector is available and the preferred connection method. For probes that use an alternate connector, the board can be purchased with a two-pin header instead of the BNC. Modification of the probe's wires may be needed and isn't recommended unless you know what you are doing.</p> <h3 id="probe-selection"><a href="#probe-selection" aria-hidden="true" class="header-anchor">#</a> Probe Selection</h3> <p>Any 2-electrode probe can be attached to the device.</p> <p>A probe with a K cell-constant of:</p> <ul><li>0.1K can measure from 0.06 - 199.9 uS</li> <li>1K from 0 - 1999 uS</li> <li>10K from 1 - 200 mS</li></ul> <h1>Getting Started</h1> <p>To start developing for the device, you need to install a library for your board/platform.</p> <div><ul><li><p><strong>Arduino IDE</strong>:  go to the library manager (Sketch / Include Library / Manage Libraries...) and search for EC Salinity.</p></li> <li><p><strong>PlatformIO</strong>: install the library using the library manager (PlatformIO / PlatformIO Home / Libraries) and search for EC Salinity.</p></li> <li><p><strong>Particle.io</strong>: search for EC_Salinity in the Libraries section of the IDE.</p></li> <li><p><strong>MicroPython</strong>: clone the <a href="https://github.com/u-fire/ECSalinity" target="_blank" rel="noopener noreferrer">GitHub repo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. In the <code>python/MicroPython</code> directory, you will find the files for various boards and their accompanying README files with instructions.</p></li> <li><p><strong>Raspberry Pi</strong>:  clone the <a href="https://github.com/u-fire/ECSalinity" target="_blank" rel="noopener noreferrer">GitHub repo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. In the <code>python/RaspberryPi</code> directory, you will find the files for various boards and their accompanying README files with instructions. Be sure to read the section below for instructions.</p></li> <li><p><strong>Rust</strong>: Download/install/documentation for the <a href="https://crates.io/crates/ufire_ec" target="_blank" rel="noopener noreferrer">crate<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul></div> <h2 id="raspberry-pi"><a href="#raspberry-pi" aria-hidden="true" class="header-anchor">#</a> Raspberry Pi</h2> <p>Before you can run anything, you will need to enable software I2C, as the Pi's hardware implementation has a clock-stretching bug that will prevent it from working with the probe (or any other device that uses clock-stretching).</p> <div><ol><li><p><code>sudo nano /boot/config.txt</code> and scroll to the bottom</p></li> <li><p>Add
<code>dtoverlay=i2c-gpio,i2c_gpio_sda=&lt;pin&gt;,i2c_gpio_scl=&lt;pin&gt;</code>
replacing <code>&lt;pin&gt;</code> with whatever pin you'd like to use. Refer <a href="https://docs.microsoft.com/en-us/windows/iot-core/media/pinmappingsrpi/rp2_pinout.png" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> for the pin functions, you will need to use the orange GPIO xx labels in the picture to locate the pins.</p></li> <li><p><code>ctrl + x</code> to exit, <code>y</code> to save, and <code>enter</code> to confirm the filename.</p></li> <li><p>Reboot</p></li></ol></div> <h2 id="the-shell-example"><a href="#the-shell-example" aria-hidden="true" class="header-anchor">#</a> The shell Example</h2> <div><p>An interactive shell interface is provided with all frameworks and is a quick and easy way to get started using the device. You will find the equivalent commands in the code area to the right when applicable. Upload it to your master device, start a serial terminal and you will be presented with a <code>&gt;</code> prompt where you can enter commands and receive a response, similar to a shell command line or REPL. It is often quicker to experiment with things this way rather than rewriting, compiling, and uploading new versions every time.</p></div> <h2 id="changing-the-i2c-address"><a href="#changing-the-i2c-address" aria-hidden="true" class="header-anchor">#</a> Changing the I2C Address</h2> <div><p>If needed, the I2C address can be changed programatically by calling <code>setI2CAddress()</code>. The device will permanently change the address and continue to use it after a power reset. If you forget the new address, you will need to use an I2C bus scanner to locate it again.</p></div> <h3 id="class-initialization"><a href="#class-initialization" aria-hidden="true" class="header-anchor">#</a> Class Initialization</h3> <div><ul><li><strong>C++</strong>: There are several class constructors available.
<ul><li><strong>Default</strong>: <code>EC_Salinity ec;</code></li> <li><strong>Custom I2C Address</strong>: <code>EC_Salinity ec(0x4C);</code></li> <li><strong>ESP32 I2C Pins (SDA, SCL)</strong>: <code>EC_Salinity ec(19, 23);</code></li> <li><strong>ESP32 I2C Pins and I2C Address</strong>: <code>EC_Salinity ec(19, 23, 0x4C);</code></li></ul></li> <li><strong>Raspberry Pi Python</strong>: Always pass the I2C address in the constructor, 0x3f by default. 3 indicates the third I2C device (/dev/i2c-3).
<ul><li><strong>Default</strong>: ec = ecsalinity(0x3c, 3)</li></ul></li> <li><strong>MicroPython</strong>: Always pass the I2C address in the constructor, 0x3c by default. -1 indicates to use software I2C, and then specify the SCL and SDA pins.
<ul><li><strong>Default</strong>: ec = ecsalinity(0x3c, -1, 5, 4)</li></ul></li></ul></div> <h1>Calibration</h1> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;ECSalinity.h&gt;</span></span>
EC_Salinity ec<span class="token punctuation">;</span>
<span class="token keyword">float</span> calibrationSolution_mS <span class="token operator">=</span> <span class="token number">2.77</span><span class="token punctuation">;</span>

ec<span class="token punctuation">.</span><span class="token function">setK</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ec<span class="token punctuation">.</span><span class="token function">calibrateDry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ec<span class="token punctuation">.</span><span class="token function">calibrateProbe</span><span class="token punctuation">(</span>calibrationSolution_mS<span class="token punctuation">,</span> ec<span class="token punctuation">.</span>tempCoefEC<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">from</span> ecsalinity <span class="token keyword">import</span> ecsalinity
ec <span class="token operator">=</span> ecsalinity<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
calibrationSolution_mS <span class="token operator">=</span> <span class="token number">2.77</span>
ec<span class="token punctuation">.</span>setK<span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span>
ec<span class="token punctuation">.</span>calibrateDry<span class="token punctuation">(</span><span class="token punctuation">)</span>
ec<span class="token punctuation">.</span>calibrateProbe<span class="token punctuation">(</span>calibrationSolution_mS<span class="token punctuation">,</span> ec<span class="token punctuation">.</span>tempCoefEC<span class="token punctuation">)</span>
</code></pre></div><div class="language-shell extra-class"><pre class="language-text"><code>k 1.0
dry
cal 2.77
</code></pre></div><p>When the device is powered for the first time, it will be uncalibrated. There are two calibration options: single and dual point. Single point determines a percent difference between actual readings and expected readings, then uses it to make adjustments. Dual point uses two points, a high and low, to determine the adjustment to make. The choice of single or dual depends on the expected use. A small range might be better measured by single point calibration whereas a large range may be more accurate with dual point.</p> <p>Before any measurements can be made, to include measurements to calibrate the probe, the cell constant (K) must be specified. This number is typically 0.1, 1.0, or 10.0. The exact value may be found on the probe itself (9.988 for example).</p> <div><p>After setting K, you can optionally calibrate the probe to determine the reading it returns when it is dry. <code>calibrateDry()</code> will record the measurment and automatically be used for subsequent measurments. If the value is equal to or less than the dry value, -1 is returned. This indicates the probe is dry or also if it is unconnected.</p></div> <p>For best results, the probe should be cleaned with distilled water or vinegar and then placed in the solution for 5-10 minutes before the probe is used. It shouldn't be placed on the bottom or side of the solution container. Any turbidity, air bubbles, large particles, or unstable temperature will effect readings.</p> <p>When calibrating the probe, it is important to consider the expected temperature range. EC measurements are very temperature dependent, effecting the results by approximately 2% per degree C. The probe should be calibrated at the median expected temperature.</p> <p>Likewise, the probe should be calibrated in the median expected EC range. For example, if you are planning to measure the salinity of an aquarium, you might expect readings ±5 from 35PPT (equivalent to 53mS). So a 53mS solution for calibration would be appropriate, whereas a hydroponic calibration might be 2.77mS or lower.</p> <p>Another consideration is the placement of the probe. When the probe sends out a pulse of electricity, it leaves the probe in 360 degrees. If it is near metal, you will experience fringing effects. The probe should be calibrated in an environment as similar as possible to the location it will be deployed in.</p> <h3 id="single-point"><a href="#single-point" aria-hidden="true" class="header-anchor">#</a> Single Point</h3> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">float</span> solutionEC <span class="token operator">=</span> <span class="token number">53.0</span><span class="token punctuation">;</span>
ec<span class="token punctuation">.</span><span class="token function">calibrateProbe</span><span class="token punctuation">(</span>solutionEC<span class="token punctuation">,</span> ec<span class="token punctuation">.</span>tempCoefSalinity<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>solutionEC <span class="token operator">=</span> <span class="token number">53.0</span>
ec<span class="token punctuation">.</span>calibrateProbe<span class="token punctuation">(</span>solutionEC<span class="token punctuation">,</span> ec<span class="token punctuation">.</span>tempCoefSalinity<span class="token punctuation">)</span>
</code></pre></div><div class="language-shell extra-class"><pre class="language-text"><code>cal 53.0
</code></pre></div><div><p>For this method of calibration, submerge the probe and wait for the readings to stabilize. Then call <code>calibrateProbe()</code>. The calibration information will be stored in EEPROM.</p></div> <h3 id="dual-point"><a href="#dual-point" aria-hidden="true" class="header-anchor">#</a> Dual Point</h3> <p>Two calibration solutions are required, the low and high values you expect to measure between.</p> <div><ol><li>Determine the lowest and highest measurement you expect. For example, the lowest level you might measure would be 50 mS and the highest might be 58 mS. These points will be referred to as
<code>referenceLow</code> and <code>referenceHigh</code></li> <li>Put the EC probe in a calibration solution at <code>referenceLow</code> and wait for readings to stabilize, then call
<code>calibrateProbeLow()</code>. Do the same for referenceHigh by calling 'calibrateProbeHigh()'.</li> <li>By default, the device does not use dual point, even if the values are provided. A call to <code>useDualPoint(true)</code> must be made to enable it. It will be saved in the configuration and used automatically.</li></ol></div> <div><p>You can also set all four values directly using <code>setDualPointCalibration()</code>.</p></div> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">float</span> solutionECLow <span class="token operator">=</span> <span class="token number">53.0</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> solutionECHigh <span class="token operator">=</span> <span class="token number">58.0</span><span class="token punctuation">;</span>
ec<span class="token punctuation">.</span><span class="token function">calibrateProbeLow</span><span class="token punctuation">(</span>solutionECLow<span class="token punctuation">,</span> ec<span class="token punctuation">.</span>tempCoefSalinity<span class="token punctuation">)</span><span class="token punctuation">;</span>
ec<span class="token punctuation">.</span><span class="token function">calibrateProbeHigh</span><span class="token punctuation">(</span>solutionECHigh<span class="token punctuation">,</span> ec<span class="token punctuation">.</span>tempCoefSalinity<span class="token punctuation">)</span><span class="token punctuation">;</span>
ec<span class="token punctuation">.</span><span class="token function">useDualPoint</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>solutionECLow <span class="token operator">=</span> <span class="token number">53.0</span>
solutionECHigh <span class="token operator">=</span> <span class="token number">58.0</span>
ec<span class="token punctuation">.</span>calibrateProbeLow<span class="token punctuation">(</span>solutionECLow<span class="token punctuation">,</span> ec<span class="token punctuation">.</span>tempCoefSalinity<span class="token punctuation">)</span>
ec<span class="token punctuation">.</span>calibrateProbeHigh<span class="token punctuation">(</span>solutionECHigh<span class="token punctuation">,</span> ec<span class="token punctuation">.</span>tempCoefSalinity<span class="token punctuation">)</span>
ec<span class="token punctuation">.</span>useDualPoint<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-shell extra-class"><pre class="language-text"><code>low 53.0
high 58.0
dp 1
</code></pre></div><h1>Use</h1> <p>Once the probe has been calibrated, a reading can be taken.</p> <p>After the measurement is taken, the following class variables are updated:</p> <div><ul><li><code>uS</code></li> <li><code>mS</code></li> <li><code>S</code></li> <li><code>PPM_500</code></li> <li><code>PPM_640</code></li> <li><code>PPM_700</code></li> <li><code>salinityPSU</code></li> <li><code>salinityPPT</code></li> <li><code>salinityPPM</code></li> <li><code>tempC</code></li> <li><code>tempF</code></li></ul></div> <h2 id="temperature-compensation"><a href="#temperature-compensation" aria-hidden="true" class="header-anchor">#</a> Temperature Compensation</h2> <div class="language-cpp extra-class"><pre class="language-cpp"><code>byte tempConstant <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
ec<span class="token punctuation">.</span><span class="token function">setTempConstant</span><span class="token punctuation">(</span>tempConstant<span class="token punctuation">)</span><span class="token punctuation">;</span>
ec<span class="token punctuation">.</span><span class="token function">useTemperatureCompensation</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>tempConstant <span class="token operator">=</span> <span class="token number">20</span>
ec<span class="token punctuation">.</span>setTempConstant<span class="token punctuation">(</span>tempConstant<span class="token punctuation">)</span>
ec<span class="token punctuation">.</span>useTemperatureCompensation<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-shell extra-class"><pre class="language-text"><code>tc 1 20
tc 0
</code></pre></div><p>Conductivity naturally changes with temperature. When the temperature drops, the solution condences, molecules move closer together and allow a charge to more easily pass. The opposite occurs when the temperature increases.</p> <p>Temperature compensation is used to calculate what the measured conductivity would be if it were measured at a different temperature. This is just an approximation and is determined by the temperature coefficient as explained below.</p> <div><p>To set the temperature used for compensation, call <code>setTempConstant()</code> and pass the temperature to use; the temperature probe must be connected for this measurement. Calling <code>measureEC()</code> or <code>measureSalinity()</code> will also call <code>measureTemp()</code> before taking a measurement if <code>usingTemperatureCompensation()</code> has been set to true.</p></div> <div><p>The values passed to <code>setTempConstant()</code> and <code>useTemperatureCompensation()</code> will be saved and used automatically.</p></div> <h2 id="temperature-coefficients"><a href="#temperature-coefficients" aria-hidden="true" class="header-anchor">#</a> Temperature Coefficients</h2> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">float</span> pureWaterCompensation <span class="token operator">=</span> <span class="token number">0.0455</span><span class="token punctuation">;</span>
ec<span class="token punctuation">.</span><span class="token function">measureEC</span><span class="token punctuation">(</span>pureWaterCompensation<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ec<span class="token punctuation">.</span><span class="token function">measureEC</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ec<span class="token punctuation">.</span><span class="token function">measureSalinity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>pureWaterCompensation <span class="token operator">=</span> <span class="token number">0.0455</span>
ec<span class="token punctuation">.</span>measureEC<span class="token punctuation">(</span>pureWaterCompensation<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
ec<span class="token punctuation">.</span>measureEC<span class="token punctuation">(</span><span class="token punctuation">)</span>
ec<span class="token punctuation">.</span>measureSalinity<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-shell extra-class"><pre class="language-text"><code>ec
sal
</code></pre></div><p>Temperature coefficients are used in compensating for temperature. Values vary depending on the type of solution being measured and the source providing the numbers. In common usage, ultra-pure, freshwater, and saltwater have distinct values.</p> <div><p>If the solution to be measured is saltwater, use <code>measureSalinity()</code>, if it is freshwater, use <code>measureEC()</code>. A custom temperature coefficient can be used by passing it to <code>measureEC()</code>.</p></div> <h2 id="measurement-time"><a href="#measurement-time" aria-hidden="true" class="header-anchor">#</a> Measurement Time</h2> <p>Each individual EC measurement takes 250ms. A temperature measurement takes 750ms.</p> <h2 id="isolation-and-interference"><a href="#isolation-and-interference" aria-hidden="true" class="header-anchor">#</a> Isolation and Interference</h2> <p>Using any water quality measuring probe with another probe will likely cause interference. There are many factors that determine the amount to include the grounding of the solution, the type of probes, the solution itself, chemical reactions that may take place, etc. The EC-Salinity board doesn't provide a path from the probe's electrodes to ground, minimizing the interference, however it doesn't mean it has zero impact. The only way to ensure interference doesn't cause faulty measurements is to isolate the circuit.</p> <p>Each probe would need to be isolated from each other using either a galvanic isolation circuit, or connected to separated battery powered devices, transmitting information via <a href="https://github.com/u-fire/uFire_BLE" target="_blank" rel="noopener noreferrer">bluetooth<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> or <a href="https://github.com/u-fire/uFire_WS" target="_blank" rel="noopener noreferrer">WiFi<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, for example.</p> <h1>More Help</h1> <p>If you have any questions, find a bug, or have any suggestions, go to this project's <a href="https://github.com/u-fire/ECSalinity" target="_blank" rel="noopener noreferrer">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> page and submit an Issue or Pull Request. Or you can send an email to <a href="mailto:questions@ufire.co">questions@ufire.co</a>.</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/ECSalinity/api.html">
          Class Members
        </a> →
      </span></p></div> </div></div></div>
    <script src="/ECSalinity/assets/js/5.7e5ed0e9.js" defer></script><script src="/ECSalinity/assets/js/app.56bde8e3.js" defer></script>
  </body>
</html>
